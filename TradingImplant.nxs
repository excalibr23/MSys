{"name":"starwraith trading implant","enabled":true,"description":"v0.5","type":"group","id":1,"items":[{"type":"function","name":"onLoad","enabled":true,"id":2,"code":"//Commands to send on login\n\n// Starwraith Trading Implant\nSTI = {\n    version: 0.5,\n    shortname: 'STI',\n    packagename: 'starwraith trading implant',\n    content: \"\",\n    noticecolor: 'gold',\n    // Parsing states\n    state: 0,\n    STATE_START: 0,\n    STATE_HEADER: 1,\n    STATE_DIVIDER: 2,\n    STATE_CONTENT: 3,\n    // Functions\n    disableGroup: function(name) {\n        var group = reflex_find_by_name('group', name, false, false, STI.packagename)\n        reflex_disable(group)\n    },\n    enableGroup: function(name) {\n        var group = reflex_find_by_name('group', name, false, false, STI.packagename)\n        reflex_enable(group)\n    },\n    disable: function(name, type = 'group') {\n        var group = reflex_find_by_name(type, name, false, false, STI.packagename)\n        reflex_disable(group)\n    },\n    enable: function(name, type = 'group') {\n        var group = reflex_find_by_name(type, name, false, false, STI.packagename)\n        reflex_enable(group)\n    },\n    notice: function(text) {\n        display_notice(\"[\" + STI.shortname + \"] \" + text, STI.noticecolor);\n    },\n    helpbox: function(title,text) {\n        var helptext = \"<div class=\\\"mono\\\"><span style=\\\"color: #ffffff; \\\"><span style=\\\"background-color: #0000a0 \\\">\" + title + \"</span></span></div>\";\n        helptext += \"<div class=\\\"mono\\\">\" + text.replace(\"\\n\",\"</div><div class=\\\"mono\\\">\") + \"</div>\";\n        client.display_help_window(helptext);\n\t},\n    loaded: function() {\n\t\tSTI.notice(\"Starwraith Trading Implant v\" + STI.version + \" Loaded. Use GETORDERS to download market orders.\\n\");// See TRADINGHELP for more information.\\n\");\n    },\n    escape: function(input) {\n        if(input.indexOf(\" \")!=-1) {\n            return \"\\\"\" + input.replace(\"\\\"\",\"\\\\\\\"\") + \"\\\"\";\n        } \n        return input;\n    },\n    locations: {\n        // Stations\n        \"Atheni Station\": \"Atheni,RS,55,50,98,112\",\n        \"Bakal Station\": \"Tycho,RA,53,36,146,182\",\n        // Barbella\n        // Barrak\n        // Benu\n        \"The Celestine Crossings\": \"Glisal,,,,98,112\",\n        // Danica\n        \"Elonova Station\": \"Elonova,RA,44,38,97,118\",\n        // Eta Zeniah\n        // Faleon\n        // Frixion\n        // Gallen\n        // Gunurash\n        \"Iota Station\": \"Iota,CS,38,38,49,120\",\n        // Inkke\n        // Ixodon\n        // Izaren\n        // Khayrat\n        // Kholod\n        // Lekknis\n        // Maqbahassum\n        // Nocturne\n        // Norpisa\n        \"Omni Station\": \"Aleph,CA,40,40,125,125\",\n        // Paskal\n        // Pylos \n        // Rensu\n        // Renshi\n        // Reynolds\n        // Ry'nari\n        // Seanan\n        // SGA-Solace\n        \"The Starlily\": \"Orpheon,CS,44,39,49,120\",\n        // Tethan\n        // Uycheon\n        // Valdorn\n\n       \t// Planets\n        \"Usum Usutti\": \"Iota,CS,38,38,38,104\",\n        \n        // Visited\n        \"CS-4136-Rilvania\":\",CS,41,36,138,90\",\n        \"CS-4136-Thorasia\":\",CS,41,36,18,121\",\n        \"CS-4137-Clilon\":\",CS,41,37,178,146\",\n        \"CS-4239-Jesria\":\",CS,42,39,126,234\",\n        \"CS-4239-Zenagus\":\",CS,42,39,107,129\",\n        \"CS-4338-Thonelbel\":\",CS,43,38,113,158\",\n        \"CS-4435-Pertos\":\",CS,44,35,93,128\",\n        \"CS-4536-Blabgus\":\",CS,45,36,130,137\",\n        \"CS-4536-Japeltede\":\",CS,45,36,195,54\",\n        \"CS-4536-Kapilax\":\",CS,45,36,156,86\",\n        \"CS-4536-Limrad\":\",CS,45,36,118,40\",\n        \"CS-4536-Quzar\":\",CS,45,36,30,8\",\n        \"CS-4639-Zintos\":\",CS,46,39,62,234\",\n        \"CS-4640-Katenuium\":\",CS,46,40,62,234\",\n        \"CS-4640-Partica\":\",CS,46,40,48,156\",\n        \"CS-4640-Sizoria\":\",CS,46,40,151,106\",\n\t},\n    parse_order_line: function(input) {\n        var id     = STI.escape(input.substring(0,6).trim());\n        var cargo  = STI.escape(input.substring(6,22).trim());\n        var qtytot = input.substring(22,38).split(\"/\");\n        var qty    = STI.escape(qtytot[0].trim());\n        var tot    = STI.escape(qtytot[1].trim());\n        var dest_name = input.substring(38,62).trim();\n        var dest   = STI.escape(dest_name);\n        var price  = STI.escape(input.substring(62,72).trim());\n        var escrow = STI.escape(input.substring(72).trim());\n\t\t\n        var line = id + \",\" + cargo  + \",\" + qty + \",\" + tot + \",\" + dest + \",\" + price  + \",\" + escrow\n        \n        if (STI.locations[dest_name] != undefined) {\n            line += \",\" + STI.locations[dest_name];\n        } else {\n            var loc = dest.match(/([CR][AS])-(\\d{2})(\\d{2})-.*/);\n\n            if (loc != null)\n            {\n                line += \",,\" + loc[1] + \",\" + loc[2] + \",\" + loc[3]\n            }\n\t\t}\n        \n        return line;\n\t},\n    encode: function(input) {\n        return input.replace(/[\\u00A0-\\u9999<>\\&]/gim, function(i) {\n            return '&#'+i.charCodeAt(0)+';';\n\t\t});\n    },\n    download: function(filename, text) {\n  \t\tvar element = document.createElement('a');\n\n    \telement.setAttribute('href', 'data:text/octet-stream,' + encodeURIComponent(text));\n  \t\telement.setAttribute('download', filename);\n\n  \t\telement.style.display = 'none';\n  \t\tdocument.body.appendChild(element);\n\n  \t\telement.click();\n    \n  \t\tdocument.body.removeChild(element);\n\t}\n}\n\nSTI.loaded();"},{"type":"group","name":"Market Orders","enabled":true,"id":3,"items":[{"type":"trigger","name":"Start Market Orders","enabled":false,"id":5,"matching":"exact","whole_words":false,"case_sensitive":false,"text":"-------------------------------&lt; Market orders &gt;-------------------------------","actions":[{"action":"gag"},{"action":"script","script":"STI.state = STI.STATE_HEADER;\nSTI.content = \"\";"},{"action":"enable","type":"trigger","name":"Order Lines"}]},{"type":"trigger","name":"Order Lines","enabled":false,"id":7,"matching":"regexp","whole_words":true,"case_sensitive":true,"text":".*","actions":[{"action":"gag"},{"action":"script","script":"switch (STI.state) {\n    case STI.STATE_HEADER: // Parse the headers\n        var values = args.input.replace(\"Quantity\",\"Quantity   Total\").split(/ {2,}/).concat([\"Z,Q,X,Y,x,y\"]).join(\",\");\n        STI.content += values + '\\n';\n        \n        STI.state = STI.STATE_DIVIDER;\n    \tbreak;\n\n    case STI.STATE_DIVIDER: // Ignore the first divider\n        STI.state = STI.STATE_CONTENT;\n    \tbreak;\n\n    case STI.STATE_CONTENT:\n        if (args.input.startsWith(\"Type MORE to continue reading.\")) {\n            send_command('MORE');\n        } else if (args.input.length < 72 || args.input.startsWith(\"[ Speed:\") ) {\n            // Ignore\n        } else if (args.input == \"-------------------------------------------------------------------------------\") {\n            STI.state = STI.STATE_START;\n            STI.disable('Order Lines','trigger'); // Stop capturing\n\n            // Create a file to download\n            STI.download(\"market_orders.csv\", STI.content);\n            \n            STI.notice(\"Done.\");\n            \n        } else {\n            // Parse the content\n            STI.content += STI.parse_order_line(args.input) + '\\n';\n        }\n    \tbreak;\n        \n  default:\n}"},{"action":"disable","type":"trigger","name":"Start Market Orders"}]},{"type":"alias","name":"getorders - Get Market Orders","enabled":true,"id":8,"matching":"exact","whole_words":true,"case_sensitive":false,"prefix_suffix":true,"actions":[{"action":"script","script":"STI.notice(\"Getting market orders...\");"},{"action":"enable","type":"trigger","name":"Start Market Orders"},{"action":"command","command":"MARKET ORDER LIST","prefix_suffix":true}],"text":"getorders"}],"actions":[]},{"type":"group","name":"Market","enabled":true,"id":9,"items":[{"type":"alias","name":"mol <filter> - Market Order List","enabled":true,"id":10,"matching":"exact","whole_words":true,"case_sensitive":false,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET ORDER LIST @filter","prefix_suffix":true}],"text":"mol <filter>"},{"type":"alias","name":"mot <id> <amt> - Market Order Take","enabled":true,"id":12,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET ORDER TAKE @id @amt","prefix_suffix":true}],"text":"mot <id> <amt>"},{"type":"alias","name":"mof <id> - Market Order Fulfill","enabled":true,"id":13,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET ORDER @id FULFILL","prefix_suffix":true}],"text":"mof <id>"},{"type":"alias","name":"moa <qty> <cargo> <dest> <price> - Market Order Ask","enabled":true,"id":23,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET ORDER ASK @qty @cargo AT @dest FOR @price","prefix_suffix":true}],"text":"moa <qty> <cargo> <dest> <price>"},{"type":"alias","name":"moc <id> - Market Order Cancel","enabled":true,"id":22,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET ORDER CANCEL @id","prefix_suffix":true}],"text":"moc <id>"},{"type":"alias","name":"mfl <filter> - Market Offer List","enabled":true,"id":14,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET OFFER LIST @filter","prefix_suffix":true}],"text":"mfl <filter>"},{"type":"alias","name":"mfb <n> <cargo> <max> - Market Offer Buy","enabled":true,"id":15,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"MARKET BUY @n @cargo @max","prefix_suffix":true}],"text":"mfb <n> <cargo> <max>"}],"actions":[]},{"type":"group","name":"Cargo","enabled":true,"id":19,"items":[{"type":"alias","name":"cca - Cargo Contents All","enabled":true,"id":11,"matching":"exact","whole_words":true,"case_sensitive":false,"prefix_suffix":true,"actions":[{"action":"command","command":"CARGO CONTENTS ALL","prefix_suffix":true}],"text":"cca"},{"type":"alias","name":"cl <qty> <cargo> - Cargo load","enabled":true,"id":20,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"CARGO LOAD @qty @cargo","prefix_suffix":true}],"text":"cl <qty> <cargo>"},{"type":"alias","name":"cs <qty> <cargo> - Cargo store","enabled":true,"id":21,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"CARGO STORE @qty @cargo","prefix_suffix":true}],"text":"cs <qty> <cargo>"}],"actions":[]},{"type":"group","name":"Harvesting","enabled":true,"id":16,"items":[{"type":"trigger","name":"","enabled":true,"id":17,"matching":"begins","whole_words":true,"case_sensitive":true,"text":"The ship collects the surrounding <gas> into its scoops, bringing the collected total to <total>.","actions":[{"action":"highlight","highlight":"match","highlight_backref":"1","highlight_fg":"#ffff00","highlight_bg":"#000000"},{"action":"highlight","highlight":"backref","highlight_backref":"1","highlight_fg":"#00f4ff","highlight_bg":"#000000"}]}],"actions":[]},{"type":"alias","name":"fc <tar> - Fire cannon","enabled":true,"id":18,"matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"command","command":"SHIP WEAPON FIRE CANNON @target","prefix_suffix":true}],"text":"fc <target>"}]}