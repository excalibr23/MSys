{
    "type": "group",
    "name": "msysnanoseer",
    "enabled": true,
    "id": 1,
    "items": [
        {
            "type": "function",
            "name": "onLoad",
            "enabled": true,
            "id": 2,
            "code": "if (MSys == undefined || MSys.coreVersion == undefined || MSys.coreVersion < 1.3) {
    display_notice('Starwraith Nanoseer Combat Implant requires MSysCore v1.3 or later','gold');
    return;
}

//Nano
MSys.shortname = 'SNCI'
MSys.nanites = 0
MSys.maxNanites = 0
MSys.sanity = 0
MSys.maxSanity = 0
MSys.multistrike = false
MSys.frenzy = false
MSys.freeze = false
MSys.delaySwarm = false
MSys.pointZero = false
MSys.speedup = false
MSys.negation = false
MSys.empyreal = ''
MSys.useDelay = get_variable('useDelay')
MSys.useMultistrike = get_variable('useMultistrike')
MSys.useFrenzy = get_variable('useFrenzy')
MSys.usePointZero = get_variable('usePointZero')
MSys.useSpeedup = get_variable('useSpeedup')
MSys.useFreeze = get_variable('useFreeze')
MSys.useNegation = get_variable('useNegation')
MSys.huntingAttack = function() {
    if (!this.systemEnabled) {return}
    var command = ''

    //Self heal
    if (this.health / this.maxHealth < .8 && this.healReady && this.useHeal) {
        this.debugMessage('Nano repair')
        send_command('nano repair')
        return

        //Out of combat buffs
        //Casting and channeling are separated to enable the buff to be executed
        //immediately if already channeling one of the required empyreals
        //This prevents unnecessary swapping of empyreal channels after combat
    } else if (!this.negation && this.useNegation && this.empyreal == 'Progenitor') {
        this.debugMessage('Cast Negation')
        send_command('negation')
        return

    } else if (!this.frenzy && this.useFrenzy && this.empyreal == 'Conqueror') {
        this.debugMessage('Cast Frenzy')
        send_command('frenzy')
        return

    } else if (!this.frenzy && this.useFrenzy && this.empyreal != 'Conqueror') {
        this.debugMessage('Channel conqueror')
        send_command('oblivion channel conqueror')
        return

    } else if (!this.negation && this.useNegation && this.empyreal != 'Progenitor') {
        this.debugMessage('Channel Progenitor')
        send_command('oblivion channel progenitor')
        return

        //Abort execution of offensive actions if disabled
    } else if (!this.offenseEnabled || get_variable('tar') == '') {
        this.debugMessage('No target or offense disabled')
        return

        //Combat buffs
    } else if (!this.speedup && this.useSpeedup && this.empyreal != 'Traveller') {
        this.debugMessage('Channel Traveller')
        send_command('oblivion channel Traveller')
        return

    } else if (!this.speedup && this.useSpeedup && this.empyreal == 'Traveller') {
        this.debugMessage('Cast Speedup')
        send_command('speedup')
        return

    } else if (!this.pointZero && this.usePointZero) {
        this.debugMessage('Point Zero')
        send_command('void pointzero')
        return

    } else if (!this.delaySwarm && this.useDelay) {
        this.debugMessage('Delay Attack')
        command =  'delay '
        command += get_variable('delayAttack')
        command += ' '

    } else if (!this.multistrike && this.targetHealth > 40 && this.useMultistrike) {
        this.debugMessage('Multistrike')
        command = 'multistrike '

    } else if (!this.freeze && this.useFreeze && this.targetHealth > 20 ) {
        this.debugMessage('Freeze')
        command = 'freeze '

    } else {
        this.debugMessage('Default Attack')
        command = this.attack + ' '
    }

    command += get_variable('tar')
    send_command(command)          
}

MSys.loaded(\"Starwraith Nanoseer Combat Implant v1.3\");
send_command('wakeup');",
            "items": []
        },
        {
            "type": "function",
            "name": "onGMCP",
            "enabled": true,
            "id": 3,
            "code": "// Place any code here you'd like to run when a GMCP message is received
// - The GMCP message is received as \"args.gmcp_method\" and \"args.gmcp_args\"

GMCP[args.gmcp_method] = args.gmcp_args

/* ------------------------------------------ CHARACTER STUFF ----------------------------------- */

if (args.gmcp_method == \"Char.Vitals\") {
    MSys.nanites = args.gmcp_args.nn
    MSys.maxNanites = args.gmcp_args.maxnn
    MSys.sanity = args.gmcp_args.xa
    MSys.maxSanity = args.gmcp_args.maxsa
}

/* ----------------------------------- DEFENCES AND BUFFS --------------------------------------- */

if (args.gmcp_method == 'Char.Defences.Add') {
    if (args.gmcp_args.name == 'Oblivion: Conqueror')  {
        MSys.empyreal = 'Conqueror'
    } else if (args.gmcp_args.name == 'Oblivion: Traveller')  {
        MSys.empyreal = 'Traveller'
    } else if (args.gmcp_args.name == 'Oblivion: Architect')  {
        MSys.empyreal = 'Architect'
    } else if (args.gmcp_args.name == 'Oblivion: Progenitor') {
        MSys.empyreal = 'Progenitor'
    } else if (args.gmcp_args.name == 'Oblivion: Sunderer')   {
        MSys.empyreal = 'Sunderer'
    }
}
",
            "items": []
        },
        {
            "type": "group",
            "name": "Nanoseer",
            "enabled": true,
            "id": 21,
            "items": [
                {
                    "type": "group",
                    "name": "Configuration",
                    "enabled": true,
                    "id": 153,
                    "items": [
                        {
                            "type": "alias",
                            "name": "Nano Abilities - hnano",
                            "enabled": true,
                            "id": 90,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "var abilities = ''
abilities += 'Freeze: ' + get_variable('useFreeze') + '\\n'
abilities += 'Multistrike: ' + get_variable('useMultistrike') + '\\n'
abilities += 'DelaySwarm: ' + get_variable('useDelay') + '\\n'
abilities += 'UseFrenzy: ' + get_variable('useFrenzy') + '\\n'
abilities += 'Frenzy Status: ' + MSys.frenzy + '\\n'
abilities += 'Use Point Zero: ' + get_variable('usePointZero') + '\\n'
abilities += 'Point Zero Status: ' + MSys.pointZero + '\\n'
abilities += 'Use Speedup: ' + get_variable('useSpeedup') + '\\n'
abilities += 'Speedup Status: ' + MSys.speedUp + '\\n'
abilities += 'Use Negation: ' + get_variable('useNegation') + '\\n'
abilities += 'Negation Status: ' + MSys.negation + '\\n'

MSys.log(abilities, 'white')"
                                }
                            ],
                            "text": "hnano",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Freeze",
                            "enabled": true,
                            "id": 42,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.toggle('useFreeze', 'Freeze');"
                                }
                            ],
                            "text": "hfreeze",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Multistrike",
                            "enabled": true,
                            "id": 43,
                            "matching": "regexp",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.toggle('useMultistrike', 'Multistrike');"
                                }
                            ],
                            "text": "^hmulti(strike)?$",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Frenzy",
                            "enabled": true,
                            "id": 45,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.toggle('useFrenzy', 'Frenzy');"
                                }
                            ],
                            "text": "hfrenzy",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Delay Swarm",
                            "enabled": true,
                            "id": 55,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "if (get_variable('useDelay')) {
    set_variable('useDelay', false)
    MSys.useDelay = false
    MSys.notice('Delay Disabled')
} else if (args[1] == '' && get_variable('delayAttack') == '') {
    MSys.alert('Delayed attack is not configured. Please provide a delayed attack to use\\nUsage: hdelay <attack>', 'red', 'black')
    return
} else {
    if (args[1] != '') {set_variable('delayAttack', args[1])}
    set_variable('useDelay', true)
    MSys.useDelay = true
    MSys.log('Delay Enabled', 'white')
}"
                                }
                            ],
                            "text": "hdelay[ ]?(.*)",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Point Zero",
                            "enabled": true,
                            "id": 162,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": false,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.toggle('usePointZero', 'Point Zero');"
                                }
                            ],
                            "text": "hpointzero"
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Speedup",
                            "enabled": true,
                            "id": 163,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": false,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.toggle('useSpeedup', 'Speedup');"
                                }
                            ],
                            "text": "hspeedup"
                        },
                        {
                            "type": "alias",
                            "name": "Enable/Disable Negation",
                            "enabled": true,
                            "id": 164,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": false,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.toggle('useNegation', 'Negation');"
                                }
                            ],
                            "text": "hnegation"
                        }
                    ],
                    "actions": []
                },
                {
                    "type": "group",
                    "name": "Shortcuts",
                    "enabled": true,
                    "id": 154,
                    "items": [
                        {
                            "type": "alias",
                            "name": "Void Soothe",
                            "enabled": true,
                            "id": 46,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "command",
                                    "command": "Void Soothe",
                                    "prefix_suffix": true
                                }
                            ],
                            "text": "vs",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Channel/Swap Empyreal",
                            "enabled": true,
                            "id": 22,
                            "matching": "regexp",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "var empyreal = {
    a: \"architect\",
    c: \"conqueror\",
    p: \"progenitor\",
    s: \"sunderer\",
    t: \"traveller\"
}

var command = {
    ch: \"oblivion channel \",
    sw: \"oblivion swap \"
}

send_command(command[args[1]] + empyreal[args[2]])"
                                }
                            ],
                            "text": "^(ch|sw)(a|c|p|s|t)$",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Limb drain",
                            "enabled": true,
                            "id": 53,
                            "matching": "regexp",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "limbs = {
    ll: 'left leg',
    rl: 'right leg',
    ra: 'right arm',
    la: 'left arm'
}

send_command('limbdrain ' + get_variable('tar') + ' ' + limbs[args[1]])"
                                }
                            ],
                            "text": "l(ll|rl|la|ra)",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Fly",
                            "enabled": true,
                            "id": 44,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "command",
                                    "command": "levitate",
                                    "prefix_suffix": true
                                }
                            ],
                            "text": "fly",
                            "items": []
                        },
                        {
                            "type": "alias",
                            "name": "Heal",
                            "enabled": true,
                            "id": 152,
                            "matching": "exact",
                            "whole_words": false,
                            "case_sensitive": false,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "command",
                                    "command": "nano repair",
                                    "prefix_suffix": false
                                }
                            ],
                            "text": "heal"
                        },
                        {
                            "type": "alias",
                            "name": "Delay",
                            "enabled": true,
                            "id": 47,
                            "matching": "regexp",
                            "whole_words": true,
                            "case_sensitive": true,
                            "prefix_suffix": true,
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "var command = {
    s: 'swarm'
}

send_command('delay ' + command[args[1]])"
                                }
                            ],
                            "text": "^d(s)$",
                            "items": []
                        }
                    ],
                    "actions": []
                },
                {
                    "type": "group",
                    "name": "Ability Activations",
                    "enabled": true,
                    "id": 161,
                    "items": [
                        {
                            "type": "trigger",
                            "name": "Leaving Room",
                            "enabled": true,
                            "id": 156,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": false,
                            "text": "^You walk to the",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.speedup = false
MSys.pointZero = false"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Delay Swarm On",
                            "enabled": true,
                            "id": 54,
                            "matching": "substring",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "Quickly, you program a delayed swarm attack",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.delaySwarm = true"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Freeze on",
                            "enabled": true,
                            "id": 29,
                            "matching": "substring",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "You brush your fingertips across",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.freeze = true"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Freeze off",
                            "enabled": false,
                            "id": 30,
                            "matching": "regexp",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "^.+has cured the effects of Frozen.$",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.freeze = false
MSys.huntingAttack()"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Frenzy Active",
                            "enabled": true,
                            "id": 39,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": false,
                            "text": "^A dark wave of madness rolls through your thoughts.*$|^You have already descended into a frenzy",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.frenzy = true
MSys.huntingAttack()"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Rage off",
                            "enabled": false,
                            "id": 40,
                            "matching": "regexp",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "You break out of your frenzy.",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.frenzy = false"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Frenzy Down",
                            "enabled": false,
                            "id": 38,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "You break out of your frenzy.",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.alert('Frenzy Down', 'white', 'red')"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Negation Active",
                            "enabled": true,
                            "id": 166,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": false,
                            "text": "aura descends over you like a giant, protective shadow.$|^You are already prepared to negate damage.$",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.negation = true
MSys.huntingAttack()"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Negation Down",
                            "enabled": false,
                            "id": 36,
                            "matching": "exact",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "The shadow of the Progenitor's protection springs to life around you, absorbing the damaging attack before lifting away from you, the air around you growing subtly lighter.",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.alert('Negation Down', 'white', 'red')"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Multistrike Active",
                            "enabled": true,
                            "id": 20,
                            "matching": "substring",
                            "whole_words": true,
                            "case_sensitive": true,
                            "text": "You focus intently to direct a portion of your swarm towards",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.multistrike = true
MSys.huntingAttack()"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Multistrike Return",
                            "enabled": true,
                            "id": 19,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "^The group of nanites returns back to you.$|^The nanites disperse. no longer striking",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.multistrike = false
MSys.huntingAttack()"
                                }
                            ],
                            "items": []
                        },
                        {
                            "type": "trigger",
                            "name": "Speedup Active",
                            "enabled": true,
                            "id": 157,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "^You snap your fingers, and time starts flowing faster|^Time has already been distorted|^Time has been strangely distorted here.$",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.speedup = true
MSys.huntingAttack()"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Speedup Inactive",
                            "enabled": true,
                            "id": 159,
                            "matching": "exact",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "The time distortion effect ends.",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.speedUp = false
MSys.huntingAttack()"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Point Zero Active",
                            "enabled": true,
                            "id": 158,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "^The air crackles and contracts|^Lifting your hand, you call upon the void within|^Air swirls around a point of absolute coldness here.$",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.pointZero = true
MSys.huntingAttack()"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Point Zero Inactive",
                            "enabled": true,
                            "id": 160,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "^The swirling point zero suddenly collapses",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.pointZero = false"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Empyreal Channeling",
                            "enabled": true,
                            "id": 165,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": false,
                            "text": "^You reach into your connection to the void",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "if (get_variable('my_combat')) {
    MSys.huntingAttack()
}"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Repair Used",
                            "enabled": true,
                            "id": 167,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "^You inhale a cloud of your swarm",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.healReady = false
MSys.huntingAttack()"
                                }
                            ]
                        },
                        {
                            "type": "trigger",
                            "name": "Repair Available",
                            "enabled": true,
                            "id": 168,
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": true,
                            "text": "^Your nanites can again repair your body.$",
                            "actions": [
                                {
                                    "action": "script",
                                    "script": "MSys.healReady = true
MSys.huntingAttack()"
                                },
                                {
                                    "action": "highlight",
                                    "highlight": "line",
                                    "highlight_backref": "1",
                                    "highlight_fg": "#82ea81",
                                    "highlight_bg": "#000000"
                                }
                            ]
                        }
                    ],
                    "actions": []
                },
                {
                    "type": "alias",
                    "name": "Wakeup Nanoseer",
                    "enabled": true,
                    "id": 155,
                    "matching": "exact",
                    "whole_words": true,
                    "case_sensitive": true,
                    "prefix_suffix": true,
                    "actions": [
                        {
                            "action": "command",
                            "command": "nano charge",
                            "prefix_suffix": true
                        },
                        {
                            "action": "waitfor",
                            "text": "^You start generating nanites.$|^You're already repairing your nanites.$",
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": false,
                            "expire": "6"
                        },
                        {
                            "action": "command",
                            "command": "nano rush on",
                            "prefix_suffix": true
                        },
                        {
                            "action": "waitfor",
                            "text": "^Inhaling a cloud of your swarm|^Your nanites are already boosting|haven.t learned",
                            "matching": "regexp",
                            "whole_words": false,
                            "case_sensitive": false,
                            "expire": "6"
                        },
                        {
                            "action": "command",
                            "command": "nano protect on",
                            "prefix_suffix": true
                        }
                    ],
                    "text": "wakeup"
                },
                {
                    "type": "trigger",
                    "name": "Queue Attack Nano",
                    "enabled": true,
                    "id": 9,
                    "matching": "regexp",
                    "whole_words": false,
                    "case_sensitive": false,
                    "text": "^You brush your fingertips across|^Focusing on becoming more attuned",
                    "actions": [
                        {
                            "action": "script",
                            "script": "MSys.huntingAttack()"
                        }
                    ],
                    "items": []
                }
            ],
            "actions": []
        }
    ],
    "description": "Starwraith Nanoseer Combat Implant v1.3"
}